# Single Source of Truth - Quick Reference Card\n\n## ðŸŽ¯ The Pattern\n\n```typescript\n// PARENT: Fetch ONCE\nconst [data, setData] = useState([])\nuseEffect(() => {\n  const result = await fetchData()\n  setData(result)\n}, [dependency])\n\n// PARENT: Pass to children\n<Child data={data} />\n\n// CHILD: Receive and sync\nconst Child = ({ data: propsData }) => {\n  const [localData, setLocalData] = useState([])\n  useEffect(() => {\n    if (propsData) setLocalData(propsData)\n  }, [propsData])\n}\n```\n\n---\n\n## âœ… DO's\n\n- âœ… Fetch in parent\n- âœ… Pass via props\n- âœ… Sync with useEffect\n- âœ… Update parent state\n- âœ… Let children re-render\n\n## âŒ DON'Ts\n\n- âŒ Fetch in multiple components\n- âŒ Maintain separate state\n- âŒ Ignore prop updates\n- âŒ Create independent sources\n- âŒ Bypass parent state\n\n---\n\n## ðŸ“Š Current Implementation\n\n### Parent: Transactions.tsx\n```typescript\nconst [transactionLines, setTransactionLines] = useState([])\n\nuseEffect(() => {\n  const lines = await getLineReviewsForTransaction(selectedTransactionId)\n  setTransactionLines(lines)\n}, [selectedTransactionId, refreshLinesTrigger])\n\n<UnifiedTransactionDetailsPanel transactionLines={transactionLines} />\n```\n\n### Child: UnifiedTransactionDetailsPanel.tsx\n```typescript\nconst Component = ({ transactionLines: propsTransactionLines }) => {\n  const [txLines, setTxLines] = useState([])\n  \n  useEffect(() => {\n    if (propsTransactionLines) {\n      setTxLines(propsTransactionLines)\n    }\n  }, [propsTransactionLines])\n}\n```\n\n---\n\n## ðŸ”„ Data Flow\n\n```\nUser selects transaction\n        â†“\nParent fetches lines (ONCE)\n        â†“\nParent updates state\n        â†“\nAll children receive props\n        â†“\nAll children display SAME data\n        â†“\nUser performs action\n        â†“\nParent re-fetches\n        â†“\nAll children update automatically\n```\n\n---\n\n## ðŸ“ˆ Performance\n\n| Metric | Before | After |\n|--------|--------|-------|\n| API Calls | 3 | 1 |\n| Consistency | âŒ | âœ… |\n| Sync Issues | âŒ | âœ… |\n\n---\n\n## ðŸ› Debugging\n\n### Check if synced\n```typescript\nuseEffect(() => {\n  console.log('Received:', propsTransactionLines)\n}, [propsTransactionLines])\n```\n\n### Check for independent fetches\n```typescript\n// âŒ BAD\nconst [lines, setLines] = useState([])\nuseEffect(() => {\n  const lines = await getLineReviewsForTransaction(id)\n  setLines(lines)\n}, [id])\n\n// âœ… GOOD\nuseEffect(() => {\n  if (propsTransactionLines) {\n    setLines(propsTransactionLines)\n  }\n}, [propsTransactionLines])\n```\n\n---\n\n## ðŸ“ Key Files\n\n- `src/pages/Transactions/Transactions.tsx` - Parent\n- `src/components/Transactions/UnifiedTransactionDetailsPanel.tsx` - Child\n- `src/pages/Transactions/TransactionLinesTable.tsx` - Child\n- `src/components/Approvals/EnhancedLineReviewModalV2.tsx` - Child\n- `src/services/lineReviewService.ts` - Service\n\n---\n\n## ðŸš€ Adding New Component\n\n1. Add prop to interface\n   ```typescript\n   interface Props {\n     transactionLines?: any[]\n   }\n   ```\n\n2. Receive in component\n   ```typescript\n   const Component = ({ transactionLines: propsTransactionLines }) => {\n   ```\n\n3. Sync with useEffect\n   ```typescript\n   useEffect(() => {\n     if (propsTransactionLines) {\n       setLines(propsTransactionLines)\n     }\n   }, [propsTransactionLines])\n   ```\n\n4. Pass from parent\n   ```typescript\n   <Component transactionLines={transactionLines} />\n   ```\n\n---\n\n## ðŸ“š Documentation\n\n- **Summary:** `SINGLE_SOURCE_OF_TRUTH_SUMMARY.md`\n- **Developer Guide:** `SINGLE_SOURCE_OF_TRUTH_DEVELOPER_GUIDE.md`\n- **Data Flow:** `SINGLE_SOURCE_OF_TRUTH_DATA_FLOW.md`\n- **Verification:** `SINGLE_SOURCE_OF_TRUTH_VERIFICATION_COMPLETE.md`\n- **Index:** `SINGLE_SOURCE_OF_TRUTH_INDEX.md`\n\n---\n\n## âœ¨ Status\n\nâœ… **COMPLETE AND PRODUCTION READY**\n\n